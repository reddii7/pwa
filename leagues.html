<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WAGS Leagues</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="app-icons/icon-32x32.png" sizes="32x32">
  <link rel="apple-touch-icon" href="app-icons/icon-180x180.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="icons/around-icons.min.css">
  <link rel="stylesheet" media="screen" href="css/theme.min.css">
  <link rel="stylesheet" media="screen" href="css/page.css">
  <script>
    window.onload = function () {
      const preloader = document.querySelector('.page-loading');
      preloader.classList.remove('active');
      setTimeout(() => preloader.remove(), 1500);
    };
  </script>
</head>
<body>
  <!-- Page loading spinner -->
  <div class="page-loading active">
    <div class="page-loading-inner">
      <div class="page-spinner"></div>
      <span>Loading...</span>
    </div>
  </div>

  <!-- Leagues Title and Navigation -->
  <nav class="leagues-title-nav fixed-top bg-dark">
    <div class="container d-flex align-items-center justify-content-between py-3">
      <a href="scores.html" class="btn btn-icon btn-sm btn-outline-secondary border-0 rounded-circle" aria-label="Back">
        <i class="ai-arrow-left"></i>
      </a>
      <div class="flex-grow-1 text-center">
        <div class="dropdown d-inline-block">
          <button class="btn btn-link dropdown-toggle fs-5 fw-bold text-decoration-none p-0" type="button" id="leaguesDropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
            <span id="activeLeagueName">LEAGUES</span>
          </button>
          <ul class="dropdown-menu" aria-labelledby="leaguesDropdownMenuButton" id="leaguesDropdownMenu" role="tablist">
            <li><button class="dropdown-item active" id="dropdown-league1-tab" type="button" data-bs-toggle="tab" data-bs-target="#league1-pane" role="tab" aria-controls="league1-pane" aria-selected="true">League 1</button></li>
            <li><button class="dropdown-item" id="dropdown-league2-tab" type="button" data-bs-toggle="tab" data-bs-target="#league2-pane" role="tab" aria-controls="league2-pane" aria-selected="false">League 2</button></li>
            <li><button class="dropdown-item" id="dropdown-league3-tab" type="button" data-bs-toggle="tab" data-bs-target="#league3-pane" role="tab" aria-controls="league3-pane" aria-selected="false">League 3</button></li>
            <li><button class="dropdown-item" id="dropdown-league4-tab" type="button" data-bs-toggle="tab" data-bs-target="#league4-pane" role="tab" aria-controls="league4-pane" aria-selected="false">League 4</button></li>
          </ul>
        </div>
      </div>
      <div style="width: 2.25rem; height: 2.25rem;"></div> <!-- Spacer to balance the back button -->
    </div>
  </nav>

  <main class="page-wrapper leagues-page-wrapper">
    <div class="py-4">
      <div class="container pt-5">
        <div class="tab-content" id="leaguesTabContent">
          <!-- League 1 Pane -->
          <div class="tab-pane fade show active" id="league1-pane" role="tabpanel" tabindex="0">
            <div class="table-responsive">
              <table class="table table-hover text-start mb-0">
                <thead>
                  <tr>
                    <th scope="col" class="text-center">POS</th>
                    <th scope="col">NAME</th>
                    <th scope="col" class="text-center">BEST 10</th>
                  </tr>
                </thead>
                <tbody id="league1TableBody">
                  <!-- League 1 data will be injected here by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
          <!-- League 2 Pane -->
          <div class="tab-pane fade" id="league2-pane" role="tabpanel" tabindex="0">
            <div class="table-responsive">
              <table class="table table-hover text-start mb-0">
                <thead>
                  <tr>
                    <th scope="col" class="text-center">POS</th>
                    <th scope="col">NAME</th>
                    <th scope="col" class="text-center">BEST 10</th>
                  </tr>
                </thead>
                <tbody id="league2TableBody">
                  <!-- League 2 data will be injected here by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
          <!-- League 3 Pane -->
          <div class="tab-pane fade" id="league3-pane" role="tabpanel" tabindex="0">
            <div class="table-responsive">
              <table class="table table-hover text-start mb-0">
                <thead>
                  <tr>
                    <th scope="col" class="text-center">POS</th>
                    <th scope="col">NAME</th>
                    <th scope="col" class="text-center">BEST 10</th>
                  </tr>
                </thead>
                <tbody id="league3TableBody">
                  <!-- League 3 data will be injected here by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
          <!-- League 4 Pane -->
          <div class="tab-pane fade" id="league4-pane" role="tabpanel" tabindex="0">
            <div class="table-responsive">
              <table class="table table-hover text-start mb-0">
                <thead>
                  <tr>
                    <th scope="col" class="text-center">POS</th>
                    <th scope="col">NAME</th>
                    <th scope="col" class="text-center">BEST 10</th>
                  </tr>
                </thead>
                <tbody id="league4TableBody">
                  <!-- League 4 data will be injected here by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Back to top button -->
  <a class="btn-scroll-top" href="#top" data-scroll aria-label="Scroll back to top">
    <svg viewBox="0 0 40 40" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <circle cx="20" cy="20" r="19" fill="none" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10"></circle>
    </svg>
    <i class="ai-arrow-up"></i>
  </a>

  <!-- Bootstrap + Theme scripts -->
  <script src="js/theme.min.js"></script>
  <script src="js/dynamic-leagues.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const activeLeagueNameSpan = document.getElementById('activeLeagueName');
      const leagueDropdownItems = document.querySelectorAll('#leaguesDropdownMenu .dropdown-item[data-bs-toggle="tab"]');

      function updateActiveLeagueName(name) {
        if (activeLeagueNameSpan) {
          activeLeagueNameSpan.textContent = name;
        }
      }

      // Set initial active league name on page load
      const initiallyActiveItem = document.querySelector('#leaguesDropdownMenu .dropdown-item.active');
      if (initiallyActiveItem) {
        updateActiveLeagueName(initiallyActiveItem.textContent);
      }

      // Add event listeners to update name when a new league is shown
      leagueDropdownItems.forEach(item => {
        item.addEventListener('shown.bs.tab', function (event) {
          updateActiveLeagueName(event.target.textContent);
        });
      });

      // GSAP Animations
      window.addEventListener('load', () => {
        // Animate navbar
        gsap.from(".leagues-title-nav > .container > *", {
          duration: 0.5,
          opacity: 0,
          y: -20,
          stagger: 0.1,
          delay: 0.2
        });

        const leagueTableBodiesIds = ['league1TableBody', 'league2TableBody', 'league3TableBody', 'league4TableBody'];
        leagueTableBodiesIds.forEach(id => {
          const tableBody = document.getElementById(id);
          if (tableBody) {
            const observer = new MutationObserver((mutationsList, obs) => {
              for (const mutation of mutationsList) {
                if (mutation.type === 'childList' && tableBody.querySelector("tr")) {
                  gsap.from(tableBody.querySelectorAll("tr"), {
                    duration: 0.5,
                    opacity: 0,
                    y: 20,
                    stagger: 0.03,
                    ease: "power2.out"
                  });
                  obs.disconnect(); // Disconnect after first animation for this table
                  break;
                }
              }
            });
            observer.observe(tableBody, { childList: true });
          }
        });
      });

      // Navbar scroll hide/show
      let lastScrollTop = 0;
      const navbar = document.querySelector('.leagues-title-nav');
      window.addEventListener('scroll', () => {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        navbar.classList.toggle('hidden', scrollTop > lastScrollTop && scrollTop > 60);
        lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
      });
    });
  </script>
</body>
</html>
